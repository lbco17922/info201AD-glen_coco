})
}
library(shiny)
source("Data_Visualizations/HH_Scatter.R")
HappyHour_server <- function(input, output) {
hh_data <- read.csv("data/HappinessAlcoholConsumption.csv", stringsAsFactors = FALSE)
output$general_scatter <- renderPlotly({
draw_hh_scatter(hh_data)
})
}
runApp('HappyHour_app.R')
plot_ly(data = hh_data, x = ~HappinessScore, y = ~GDP_PerCapita)
library(plotly)
draw_hh_scatter <- function(hh_data) {
scatter_plot <- plot_ly(data = hh_data, x = ~HappinessScore, y = ~GDP_PerCapita)
return(scatter_plot)
}
runApp('HappyHour_app.R')
library(dplyr)
hh_data_modified <- select(hh_data)
View(hh_data_modified)
hh_data_modified <- hh_data
draw_hh_scatter <- function(hh_data) {
hh_data_modified <- hh_data %>%
mutate(Alcohol_PerCapita = Beer_PerCapita + Spirit_PerCapita + Wine_PerCapita)
scatter_plot <- plot_ly(data = hh_data, x = ~HappinessScore, y = ~GDP_PerCapita)
return(scatter_plot)
}
View(hh_data_modified)
hh_data_modified <- hh_data %>%
mutate(Alcohol_PerCapita = Beer_PerCapita + Spirit_PerCapita + Wine_PerCapita)
View(hh_data_modified)
hh_data_modified <- hh_data %>%
mutate(Alcohol_PerCapita = (Beer_PerCapita + Spirit_PerCapita + Wine_PerCapita)/10)
scatter_plot <- plot_ly(data = hh_data, x = ~HappinessScore, y = ~GDP_PerCapita)
hh_data_modified <- hh_data %>%
mutate(Alcohol_PerCapita = (Beer_PerCapita + Spirit_PerCapita + Wine_PerCapita)/100)
scatter_plot <-  hh_data_modified %>%
plot_ly(type = 'scatter',
mode = 'markers',
x = ~Alcohol_PerCapita,
y = ~HappinessScore
)
return(scatter_plot)
scatter_plot <- hh_data_modified %>%
plot_ly(type = 'scatter',
mode = 'markers',
x = ~Alcohol_PerCapita,
y = ~HappinessScore
)
return(scatter_plot)
runApp('HappyHour_app.R')
scatter_plot <- hh_data_modified %>%
plot_ly(type = 'scatter',
mode = 'markers',
x = ~Alcohol_PerCapita,
y = ~HappinessScore
)
return(scatter_plot)
draw_hh_scatter <- function(hh_data) {
hh_data_modified <- hh_data %>%
mutate(Alcohol_PerCapita =
(Beer_PerCapita + Spirit_PerCapita + Wine_PerCapita)/100)
scatter_plot <- hh_data_modified %>%
plot_ly(
type = 'scatter',
x = ~Alcohol_PerCapita,
y = ~HappinessScore
)
return(scatter_plot)
}
runApp('HappyHour_app.R')
runApp('HappyHour_app.R')
source("HappyHour_server.R")
cxcx <- hh_data
scatter_choices <- unique(hh_data$Region)
scatter_choices <- unique(hh_data[,Region])
scatter_choices <- hh_data$Region
scatter_choices <- hh_data$Region
scatter_choices <- select(hh_data, Region)
View(scatter_choices)
scatter_choices <- unique(select(hh_data, Region))
View(scatter_choices)
scatter_choices <- c(unique(select(hh_data, Region)))
View(scatter_choices)
runApp('HappyHour_app.R')
HappyHour_ui <- fluidPage(
titlePanel("Relationship Between Alcohol Consumption and Happiness"),
# Main Panel
mainPanel(
navbarPage("The Navbar",
# ----- Tab panel for general summary: -----
tabPanel("Summary",
titlePanel("Summary of the Project"),
tags$div(
"What is the Problem?:", tags$br(),
"Alcohol can often be seen as the source of depression and other mental illnesses, yet, many rely on its effects to relieve stress and bring themselves joy. As such, our group aims to understand the unique relationship between happiness levels and alcohol consumption by studying the “happiness” data collected throughout various countries as well as the access they have to alcohol.
Problem Situation: The primary stakeholders for our project would most likely be current or potential consumers of alcohol as they can utilize our data to make decisions on whether or not frequent/excessive alcohol consumption will help their moods in the long run. A possible secondary stakeholder may be governments deciding how to regulate alcohol sales within their respective countries. A final possible secondary stakeholder may be alcohol companies seeing where their businesses would perform the most effectively.
Why does it matter?: Leading back to the problem statement, this matters because our group wishes to find out if alcohol actually is the cause of an improvement in mood. Our research will provide basic evidence for alcohol companies and governments in their decisions on how to regulate alcohol sales for the benefit of the public or even whether or not it would be successful in various countries."
)
),
# ----- Tab panel for the Bar Plot Visual-----
tabPanel("Scatter Plot Visual",
mainPanel(
plotlyOutput("general_scatter")
),
sidebarLayout(
sidebarPanel(
uiOutput(
"scatter_ui"
)
)
)
),
# ----- Tab panel for the Choropleth Visual -----
tabPanel("Choropleth Visual"),
# ----- Tab panel for the conclusions on data -----
tabPanel("Conclusions")
)
)
)
runApp('HappyHour_app.R')
scatter_plot <- hh_data_modified %>%
plot_ly(
type = 'scatter',
mode = 'markers',
x = ~Alcohol_PerCapita,
y = ~HappinessScore
)
runApp('HappyHour_app.R')
selectInput(
"Select your region",
label = "Please choose the region you are interested in.",
choices = as.list(c(12, 13, 14))
)
library(shiny)
source("Data_Visualizations/HH_Scatter.R")
HappyHour_server <- function(input, output) {
hh_data <- read.csv("data/HappinessAlcoholConsumption.csv", stringsAsFactors = FALSE)
output$scatter_ui <- renderUI({
selectInput(
"Select your region",
label = "Please choose the region you are interested in.",
choices = as.list(c(12, 13, 14))
)
})
output$general_scatter <- renderPlotly({
draw_hh_scatter(hh_data)
})
}
runApp('HappyHour_app.R')
library(plotly)
library(dplyr)
source("HappyHour_server.R")
draw_hh_scatter <- function(hh_data) {
hh_data_modified <- hh_data %>%
mutate(Alcohol_PerCapita =
(Beer_PerCapita + Spirit_PerCapita + Wine_PerCapita)/100)
scatter_plot <- hh_data_modified %>%
plot_ly(
type = 'scatter',
mode = 'markers',
x = ~Alcohol_PerCapita,
y = ~HappinessScore
)
return(scatter_plot)
}
library(plotly)
library(dplyr)
source("HappyHour_server.R")
draw_hh_scatter <- function(hh_data) {
hh_data_modified <- hh_data %>%
mutate(Alcohol_PerCapita =
(Beer_PerCapita + Spirit_PerCapita + Wine_PerCapita)/100)
scatter_plot <- hh_data_modified %>%
plot_ly(
type = 'scatter',
mode = 'markers',
x = ~Alcohol_PerCapita,
y = ~HappinessScore
)
return(scatter_plot)
}
library(shiny); runApp('HappyHour_app.R')
setwd("~/lionel_info201hw01/info201AD-glen_coco/HappyHour")
runApp('HappyHour_app.R')
runApp('HappyHour_app.R')
runApp('HappyHour_app.R')
runApp('HappyHour_app.R')
scatter_choices <- c(unique(select(hh_data, Region)))
output$scatter_ui <- renderUI({
selectInput(
"Select your region",
label = "Please choose the region you are interested in.",
choices = as.list(c())
)
})
output$general_scatter <- renderPlotly({
draw_hh_scatter(hh_data)
})
library(shiny)
source("Data_Visualizations/HH_Scatter.R")
HappyHour_server <- function(input, output) {
hh_data <- read.csv("data/HappinessAlcoholConsumption.csv", stringsAsFactors = FALSE)
scatter_choices <- c(unique(select(hh_data, Region)))
output$scatter_ui <- renderUI({
selectInput(
"Select your region",
label = "Please choose the region you are interested in.",
choices = as.list(c())
)
})
output$general_scatter <- renderPlotly({
draw_hh_scatter(hh_data)
})
}
runApp('HappyHour_app.R')
View(scatter_choices)
library(shiny)
source("Data_Visualizations/HH_Scatter.R")
HappyHour_server <- function(input, output) {
hh_data <- read.csv("data/HappinessAlcoholConsumption.csv", stringsAsFactors = FALSE)
scatter_choices <- unique(select(hh_data, Region))
output$scatter_ui <- renderUI({
selectInput(
"Select your region",
label = "Please choose the region you are interested in.",
choices = as.list(scatter_choices)
)
})
output$general_scatter <- renderPlotly({
draw_hh_scatter(hh_data)
})
}
runApp('HappyHour_app.R')
runApp('HappyHour_app.R')
runApp('HappyHour_app.R')
runApp('HappyHour_app.R')
runApp('HappyHour_app.R')
runApp('HappyHour_app.R')
runApp('HappyHour_app.R')
runApp('HappyHour_app.R')
runApp('HappyHour_app.R')
library(shiny); runApp('HappyHour_app.R')
library(plotly)
library(dplyr)
draw_hh_scatter <- function(hh_data, region) {
hh_data_modified <- hh_data %>%
mutate(Alcohol_PerCapita =
(Beer_PerCapita + Spirit_PerCapita + Wine_PerCapita)/100) %>%
select(Country, Region, HappinessScore, Alcohol_PerCapita) %>%
arrange(Region)
displayed_data_table <- hh_data_modified %>%
filter(Region == region)
scatter_plot <- displayed_data_table %>%
plot_ly(
type = 'scatter',
mode = 'markers',
text = ~Country,
x = ~Alcohol_PerCapita,
y = ~HappinessScore
)
scatter_plot_sized <- scatter_plot %>%
layout(autosize = F, width = 500, height = 500,
xaxis = list(range = c(0, 10)),
yaxis = list(range = c(0, 10)))
return(scatter_plot_sized)
}
library(leaflet)
library(dplyr)
library(rgdal)
draw_hh_choropleth <- function(hh_data, country_coord_data, region, factor_choice) {
# Code to set appropriate coordinates for viewing purposes #
lng_chosen = 0
lat_chosen = 0
if(region == "Australia and New Zealand") {
lng_chosen = 144.2
lat_chosen = -28.65
} else if(region == "Central and Eastern Europe") {
lng_chosen = 0.184873
lat_chosen = 51.57562
} else if(region == "Eastern Asia") {
lng_chosen = 120.766063
lat_chosen = 9.458196
} else if(region == "Latin American and Caribbean") {
lng_chosen = -84.999604
lat_chosen = 18.393694
} else if(region == "Middle East and Northern Africa") {
lng_chosen = 29.995368
lat_chosen = 31.268205
} else if(region == "North America") {
lng_chosen = -105.2551
lat_chosen = 54.5260
} else if(region == "Southeastern Asia") {
lng_chosen = 115.6628
lat_chosen = -2.2180
} else if(region == "Sub-Saharan Africa") {
lng_chosen = 11.288452
lat_chosen = 23.806078
} else if(region == "Western Europe") {
lng_chosen = 1.2644
lat_chosen = 46.2022
}
# ------------ #
hh_data_modified <- hh_data %>%
mutate(Alcohol_PerCapita =
(Beer_PerCapita + Spirit_PerCapita + Wine_PerCapita)/100) %>%
select(Country, Region, HappinessScore, Alcohol_PerCapita) %>%
arrange(Region)
hh_data_modified2 <- left_join(hh_data_modified, country_coord_data, by = "Country")
map_lines <- readOGR("Data_Visualizations/TM_WORLD_BORDERS-0.3/TM_WORLD_BORDERS-0.3.shp")
map_lines2 <- subset(map_lines, is.element(map_lines$CNTRY_NAME, hh_data_modified2$Country))
hh_data_modified3 <- hh_data_modified2[order(match(hh_data_modified2$Country, map_lines2$CNTRY_NAME)),]
# Setting bins for the two different factors #
alcohol_bin <- c(0, 1, 2, 3, 4, 5, 6, 7)
happiness_bin <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
bin_chosen <- 0
domain_chosen <- 0
pal_setting <- 0
if(factor_choice == "Alcohol per Capita") {
bin_chosen = alcohol_bin
domain_chosen = hh_data_modified3$Alcohol_PerCapita
} else if(factor_choice == "Happiness") {
bin_chosen = happiness_bin
domain_chosen = hh_data_modified3$HappinessScore
}
choro_palette <- colorBin("RdYlBu", domain = domain_chosen, bins = bin_chosen)
# ------------ #
m <- leaflet() %>% addProviderTiles(providers$Stamen.Toner) %>%
setView(lng = lng_chosen, lat = lat_chosen, zoom = 2.7) %>%
addPolygons(data = map_lines,
color = "white",
weight = 1,
smoothFactor = 1,
fillOpacity = 0.8,
fillColor = ~choro_palette(domain_chosen),
) %>%
addLegend(pal = choro_palette,
values = domain_chosen,
opacity = 0.7,
position = "topright")
return(m)
}
library(shiny)
library(plotly)
library(leaflet)
source("Data_Visualizations/HH_Scatter.R")
source("Data_Visualizations/HH_Choropleth.R")
HappyHour_server <- function(input, output) {
hh_data <- read.csv("data/HappinessAlcoholConsumption.csv", stringsAsFactors = FALSE)
country_coord_data <- read.csv("data/countries.csv", stringsAsFactors = FALSE)
scatter_choices <- unique(select(hh_data, Region))
output$scatter_ui <- renderUI({
selectInput(
inputId = "region_choice",
label = "Please choose the region you are interested in.",
choices = as.list(scatter_choices)
)
})
output$general_scatter <- renderPlotly({
draw_hh_scatter(hh_data, input$region_choice)
})
output$choropleth_ui_region <- renderUI({
selectInput(
inputId = "region_choice_2",
label = "Please choose the region you are intrested in.",
choices = as.list(scatter_choices)
)
})
output$choropleth_ui_data <- renderUI({
selectInput(
inputId = "data_choice",
label = "Please choose the factor you are interested in.",
choices = as.list(c("Alcohol per Capita", "Happiness"))
)
})
output$general_choropleth <- renderLeaflet({
draw_hh_choropleth(hh_data, country_coord_data, input$region_choice_2, input$data_choice)
})
}
library(shiny)
library(plotly)
HappyHour_ui <- fluidPage(
titlePanel(
"Happy Hour: A Glimpse at the Relationship Between Alcohol Consumption and Happiness Worldwide"
),
# Main Panel
mainPanel(
tabsetPanel(
# ----- Tab panel for general summary: -----
tabPanel("Summary and Motivation",
navbarPage(title="",
tabPanel(
"Project Overview",
tags$div(
"The goal of this project is to determine whether or not a relationship exists with happiness
worldwide, and the consumption of alcoholic beverages.  Our group wishes to find out if alcohol
actually is the cause of an improvement in mood, or if it causes the opposite, or if it is just
completely unrelated altogether. Our research will provide a surface level insight for relevant
parties (such as alcohol producing companies, breweries, retailers, and governments, for example)
to take into consideration when making their business decisions/policies. The results of this
project can be used as a reference for these parties to regulate alcohol sales for the benefit
of the public or even whether or not it would be successful in various countries."
)
),
tabPanel(
"Context",
tags$div(
"Is there a Problem?:",
tags$br(),
"Alcohol can often be seen as the source of depression and other mental illnesses, yet, many rely
on its effects to relieve stress and bring themselves joy. As such, our group aims to understand
the unique relationship between happiness levels and alcohol consumption by studying the “happiness”
data collected throughout various countries as well as the access they have to alcohol.
Problem Situation: The primary stakeholders for our project would most likely be current or potential
consumers of alcohol as they can utilize our data to make decisions on whether or not frequent/excessive
alcohol consumption will help their moods in the long run. A possible secondary stakeholder may be
governments deciding how to regulate alcohol sales within their respective countries. A final possible
secondary stakeholder may be alcohol companies seeing where their businesses would perform the most
effectively.",
tags$br(),
"Why does it matter?:",
tags$br(),
"Leading back to the problem statement, this matters because our group wishes to find out if alcohol
actually is the cause of an improvement in mood. Our research will provide basic evidence for alcohol
companies and governments in their decisions on how to regulate alcohol sales for the benefit of the
public or even whether or not it would be successful in various countries."
)
),
tabPanel(
"Affiliation",
tags$div(
"INFO-201A: Technical Foundations of Informatics,",
tags$br(),
" The Information School,",
tags$br(),
" University of Washington,",
tags$br(),
" Autumn 2019. "
)
),
tabPanel(
"Reflection",
tags$div(
"This data set was interesting to analyze because this topic is so controversial, and I
did not know that there were so many other factors that need to be analyzed to understand this topic
fully. I also think that designing this into a map will be interesting and appealing because it will
be more user interactive. It was a little frustrating getting the appendix 1 chart onto GitHub, other
than that everything was done well. This project has helped me develop my identity as a thinker because
I now know more methods on analyzing data, and know more innovative ways to present data on a certain
subject- especially using different charts and visualizations. Also in the future for my other projects
or professional work, I will be using different data sets to research a problem because then it gives
better accurate results."
)
)
)
),
# ----- Tab panel for the Bar Plot Visual-----
tabPanel(
"Scatter Plot Visualization",
mainPanel(
position = "right",
plotlyOutput("general_scatter")
),
sidebarLayout(
position = "left",
sidebarPanel(
uiOutput("scatter_ui")
),
mainPanel()
)
),
# ----- Tab panel for the Choropleth Visual -----
tabPanel(
"World Map Visualization",
mainPanel(
position = "right",
leafletOutput("general_choropleth")
),
sidebarLayout(
position = "left",
sidebarPanel(
uiOutput("choropleth_ui_region"),
uiOutput("choropleth_ui_data")
),
mainPanel()
)
),
# ----- Tab panel for the conclusions on data -----
tabPanel(
"Conclusions",
includeMarkdown("conclusion.md")
),
# ----- Tab panel for the resources on data -----
tabPanel(
"Resources",
tags$div(
"References:",
tags$br(),
"Link to Choropleth map image: https://gisgeography.com/choropleth-maps-data-classification/",
tags$br(),
"Link to Bar Graph image: https://en.wikipedia.org/wiki/File:Truncated_Bar_Graph.svg",
tags$br(),
"Data Set 1 Link: https://www.kaggle.com/marcospessotto/happiness-and-alcohol-consumption?fbclid=IwAR1m6_iknYXQGdBuRtb7G045el3rqqG3vXUjtRrya1EH_D-WxDiHxU0yBy0",
tags$br(),
"Data Set 2 Link: https://www.kaggle.com/fivethirtyeight/fivethirtyeight-alcohol-consumption-dataset"
)
)
)
)
)
runApp('HappyHour_app.R')
